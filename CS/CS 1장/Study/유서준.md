# 유서준

<aside>
💡 자바스크립트에서 0.1 + 0.2 의 결과는 왜 0.3이 아닐까요?

</aside>

### Why not 0.3?

---

```jsx
0.1 + 0.2 //0.30000000000000004
0.1 + 0.2 === 0.3 // false
```

기본적으로 컴퓨터에서 숫자는 2진법으로 표현된다. 2진법에서는 분모가 2의 거듭제곱인 분수만 유한소수로 표현될수 있는데 0.1 (1/10) 이나 0.2 (1/5) 같이 분모가 2의 거듭제곱이 아닌 숫자들은 2진법으로 표현했을때 무한소수가 된다. 그래서 0.1 과 같은 숫자는 정확히 0.1이 아닌 2진법으로 표현할수 있는 가장 가까운 숫자로 변환된다.

자바스크립트에서 숫자는 **"64비트 IEEE 754"** 방식으로 다루어 지는데 정해진 `bit` 수가 있다 (부호 1, 지수부 11, 가수부 52).  그래서 0.1 이나 0.2 같이 2진법으로 표현했을때 소수점 아래가 무한대로 이어지는 숫자들을 해당 방식으로 나타내려면 가수부의 정해진 자리에서 수를 반올림해야 된다.

![Screen Shot 2021-11-11 at 22.14.29.png](%E1%84%8B%E1%85%B2%E1%84%89%E1%85%A5%E1%84%8C%E1%85%AE%E1%86%AB/Screen_Shot_2021-11-11_at_22.14.29.png)

[고정 소수점 VS 부동 소수점 (1)](%E1%84%8B%E1%85%B2%E1%84%89%E1%85%A5%E1%84%8C%E1%85%AE%E1%86%AB/%E1%84%80%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%BC%20%E1%84%89%E1%85%A9%E1%84%89%E1%85%AE%E1%84%8C%E1%85%A5%E1%86%B7%20VS%20%E1%84%87%E1%85%AE%E1%84%83%E1%85%A9%E1%86%BC%20%E1%84%89%E1%85%A9%E1%84%89%E1%85%AE%E1%84%8C%E1%85%A5%E1%86%B7%20(1).md)

자바스크립트에서 0.3을 입력한다면 수는 한 번 반올림된다. 하지만 0.1 + 0.2를 연산하면 0.1과 0.2에서, 그리고 0.1과 0.2를 더한 값에서 반올림되기 때문에 0.1 + 0.2와 0.3은 다른 값이다.

```jsx
0.1 + 0.2 = 0.30000000000000004
0.3 = 0.29999999999999998
```

### 정수는 어디까지 정확할까?

---

**"64비트 IEEE 754"** 방식을 사용했을때 정확히 연산이 되는 정수는 `-(2^53 - 1)`부터 `2^53 - 1` 사이의 수이다. 가장 큰 정수는 **9007199254740991**, 가장 작은 정수는 **-9007199254740991**이다.

### 정확한 연산결과를 얻으려면..?

---

그럼 소숫점의 숫자를 연산할때 정확한 숫자로 계산되게 하려면 어떻게 해야될까? 자바스크립트 내장 수학 라이브러리인 Math를 사용하면 된다.

```jsx
// math.fraction()
print(math.add(math.fraction(0.1), math.fraction(0.2))) // Fraction, 0.3
print(math.divide(math.fraction(0.3), math.fraction(0.2))) // Fraction, 1.5

// toFixed()
const x = (0.1 * 0.2).toFixed(2);
console.log(x); // "0.02"
```

### Reference

[JavaScript Interview Question #14: 0.1 + 0.2 = ?](https://dev.to/coderslang/javascript-interview-question-14-0-1-0-2-41p2)

[Algorithms, Abstraction and Pseudocode](https://learn.coderslang.com/0017-algorithms-abstraction-and-pseudocode/)

[부동소수점 실수 탐구 in JavaScript](https://velog.io/@sgyoon/2019-09-15-01)

[C 프로그래밍 입문/부동소수형 데이터 - 위키책](https://ko.wikibooks.org/wiki/C_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%EC%9E%85%EB%AC%B8/%EB%B6%80%EB%8F%99%EC%86%8C%EC%88%98%ED%98%95_%EB%8D%B0%EC%9D%B4%ED%84%B0)